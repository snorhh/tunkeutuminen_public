### h4 NFC ja RFID
**1. Tarkastele käytössäsi olevia RFID tuotteita, mieti miten hyvin olet suojautunut RFID urkinnalta?**

RFID-tekniikkaa on käyttämissäni maksukorteissa sekä työpaikan avainlätkässä. Vaikka esimerkiksi maksukorttien tietoturvasta välillä näkee uutisia, niin en ole itse pyrkinyt suojautumaan mitenkään. Ehkä olen tuudittautunut siihen, että Suomessa sellaisen hyökkäyksen kohteeksi joutuminen tuntuu epätodennäköiseltä, ja ehkä minun pitäisi alkaa miettiä asiaa.

Katsoin huvikseni mitä maksukorteistani näkyy NFC Info -sovelluksella. Toista korttia kännykkäni ei lukenut, ja toisen sen kertoi sisältävän "Tag Type: ISO14443-4 & NXP: Mifare plus" sekä teknologiat IsoDep ja NfcA.

Työpaikkani avainlätkässä on yksilöllinen pin-koodi, mutta sitä tarvitaan vain virka-aikojen ulkopuolella. ChatGPT:n mukaan pin ei ole kortissa itsessään, joten sitä ei voi siitä kopioida, jos joku saisi avaimen käsiinsä. Työpaikkani ei ole mikään kriittinen firma, johon olisi erityistä hinkua murtautua, enkä ole ajatellut lätkäni tietoturvaa tähän mennessä oikeastaan lainkaan. 

Yleensä kun ajattelen tietoturvaa, niin se on itselleni tarkoittanut vain "softaa" eli käyttämiäni sovelluksia, salasanoja jne. Nyt kun tämän kurssin avulla olen oppinut erilaisista tekniikoista, niin pitäisi miettiä ja myös toteuttaa ainakin perusasiat niiden suhteen kuntoon, eikä vain toivoa parasta.

**2. Tutustu APDU komentojen rakenteeseen**

Kortinlukija ja kortti kommunikoivat toistensa kanssa APDU-viesteillä (Application Procol Data Unit). Kortinlukija lähettää kortille komentoja eli Command APDU -viestejä, ja kortti suorittaa komennon ja vastaa Response ADPU -viestillä. 

<table>
  <tr>
    <th colspan="7">Command APDU</th>
  </tr>
    <tr>
    <th colspan="4">Header (pakollinen)</th>
    <th colspan="3">Body (ei pakollinen)</th>
  </tr>
  <tr>
    <td>CLA</td>
    <td>INS</td>
    <td>P1</td>
    <td>P2</td>
    <td>Lc</td>
    <td>Data-kenttä</td>
    <td>Le</td>
  </tr>
</table>


**Kentät:**
- CLA - Class byte: määrittelee sovellusspesifisen ohjeluokan
- INS - Instruction byte - määrittelee edelliseen luokkaan kuuluvan tietyn ohjeen
- PI & P2 - ohjetavun parametrit
- Lc - Datan määrä, joka lähetetään kortille tavuina, max. 255 tavua
- Data
- Le - Vastauksessa odotettavien datatavujen maksimimäärä

<table>
  <tr>
    <th colspan="5">Response APDU</th>
  </tr>
    <tr>
    <th colspan="3">Body (ei pakollinen)</th>
    <th colspan="2">Trailer (pakollinen)</th>
  </tr>
  <tr>
    <td colspan="3">Data-kenttä</td>
    <td>SW1</td>
    <td>SW2</td>
  </tr>
</table>

**Kentät:**
- SW1 + SW2 = status word (SW), joka kertoo esim. onnistuiko komennon suorittaminen
- Data - vastauksen data

Lähteet: https://www.openscdp.org/scripts/tutorial/emv/reademv.html & https://ambimat.com/smart-card-selected-apdu-commands/ 

**3. Tutki ja kerro minkä mielenkiintoisen RFID hakkerointi uutiset löysit.**

"Major Backdoor in Millions of RFID Cards Allows Instant Cloning", Ryan Naraine, SecurityWeek, 20.8.2024 https://www.securityweek.com/major-backdoor-in-millions-of-rfid-cards-allows-instant-cloning/

Ranskalainen tietoturvayritys kertoi löytäneensä haavoittuvuuden avainkorteissa, joita käytetään miljoonissa hotellihuoneissa ja toimistoissa. Kortteja valmistaa kiinalainen merkittävä valmistaja Shanghai Fudan Microelectronics. Sattumoisin kyseinen firma juuri äskettäin päätyi Yhdysvaltain bannilistalle muista syistä (https://www.reuters.com/world/us-penalizes-two-chinese-companies-that-acquired-tools-chipmaker-smic-2025-09-12/). 

Kortit ovat artikkelin mkaan "MIFARE compatible" ja "unlicensed", eli ilmeisesti eivät täysin virallisia versioita, eivätkä kortteja käyttävät asiakkaat ehkä tiedä, että kortit eivät ole varsinaisia MIFARE-kortteja. Niitä löytyi käytössä myös Euroopasta.
